{
  "project": "shared__12e38ea922f7",
  "func_key": "src_dev_attribute_serialize_2",
  "function_name": "DeviceAttributeSet",
  "source_c_file": "src/dev_attribute_serialize.c",
  "c_code": "static _Bool DeviceAttributeSet(struct HdfDeviceInfo * attribute, struct HdfSBuf * sbuf)\n{\n    const char *svcName = HdfSbufReadString(sbuf);\n    if (svcName == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, svcName is null\");\n        return false;\n    }\n    attribute->svcName = strdup(svcName);\n    if (attribute->svcName == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, strdup svcName fail\");\n        return false;\n    }\n\n    const char *moduleName = HdfSbufReadString(sbuf);\n    if (moduleName == NULL) {\n        HDF_LOGE(\"Read from parcel failed, moduleName is null\");\n        return false;\n    }\n    attribute->moduleName = strdup(moduleName);\n    if (attribute->moduleName == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, strdup moduleName fail\");\n        return false;\n    }\n\n    const char *deviceName = HdfSbufReadString(sbuf);\n    if (deviceName == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, deviceName is null\");\n        return false;\n    }\n    attribute->deviceName = strdup(deviceName);\n    if (attribute->deviceName == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, strdup deviceName fail\");\n        return false;\n    }\n\n    uint32_t length;\n    if (!HdfSbufReadUint32(sbuf, &length)) {\n        HDF_LOGE(\"Device attribute readDeviceMatchAttr length failed\");\n        return false;\n    }\n    if (length == ATTRIBUTE_PRIVATE_DATA_LENGTH_NORMAL) {\n        const char *deviceMatchAttr = HdfSbufReadString(sbuf);\n        if (deviceMatchAttr == NULL) {\n            HDF_LOGE(\"%s: Read from sbuf failed, deviceMatchAttr is null\", __func__);\n            return false;\n        }\n        attribute->deviceMatchAttr = strdup(deviceMatchAttr);\n        if (attribute->deviceMatchAttr == NULL) {\n        HDF_LOGE(\"Read from sbuf failed, strdup deviceMatchAttr fail\");\n        return false;\n        }\n    }\n\n    return true;\n}",
  "rust_signature": "fn DeviceAttributeSet(attribute: *mut HdfDeviceInfo, sbuf: *mut HdfSBuf) -> bool",
  "rust_code": "fn DeviceAttributeSet(attribute: *mut HdfDeviceInfo, sbuf: *mut HdfSBuf) -> bool {\n    unsafe {\n        if attribute.is_null() || sbuf.is_null() {\n            return false;\n        }\n\n        let svcName = HdfSbufReadString(sbuf);\n        if svcName.is_null() {\n            return false;\n        }\n        (*attribute).svcName = strdup(svcName);\n        if (*attribute).svcName.is_null() {\n            return false;\n        }\n\n        let moduleName = HdfSbufReadString(sbuf);\n        if moduleName.is_null() {\n            return false;\n        }\n        (*attribute).moduleName = strdup(moduleName);\n        if (*attribute).moduleName.is_null() {\n            return false;\n        }\n\n        let deviceName = HdfSbufReadString(sbuf);\n        if deviceName.is_null() {\n            return false;\n        }\n        (*attribute).deviceName = strdup(deviceName);\n        if (*attribute).deviceName.is_null() {\n            return false;\n        }\n\n        let mut length: u32 = 0;\n        if !HdfSbufReadUint32(sbuf, &mut length) {\n            return false;\n        }\n\n        if length == 1 {\n            let deviceMatchAttr = HdfSbufReadString(sbuf);\n            if deviceMatchAttr.is_null() {\n                return false;\n            }\n            (*attribute).deviceMatchAttr = strdup(deviceMatchAttr);\n            if (*attribute).deviceMatchAttr.is_null() {\n                return false;\n            }\n        }\n\n        true\n    }\n}\n",
  "extracted_knowledge": [
    {
      "knowledge_type": "API_Mapping",
      "c_api": "HdfSbufReadString",
      "rust_api": "HdfSbufReadString",
      "description": "Deserialize string from sbuf",
      "mapping_type": "",
      "source": "oracle_manual"
    },
    {
      "knowledge_type": "API_Mapping",
      "c_api": "HdfSbufReadUint32",
      "rust_api": "HdfSbufReadUint32",
      "description": "Deserialize u32 from sbuf",
      "mapping_type": "",
      "source": "oracle_manual"
    },
    {
      "knowledge_type": "API_Mapping",
      "c_api": "strdup",
      "rust_api": "strdup",
      "description": "Duplicate C string",
      "mapping_type": "",
      "source": "oracle_manual"
    },
    {
      "knowledge_type": "Partial",
      "c_fragment": "if (ptr == NULL) { ... }",
      "rust_fragment": "if ptr.is_null() { ... }",
      "description": "Translate C NULL checks to Rust `is_null()` checks",
      "match_type": "partial",
      "source": "oracle_manual"
    }
  ]
}
