C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct ConfigSet {
    pub(crate) headers: String,
    pub(crate) extras: String,
    pub(crate) form_items: Vec<CFormItem>,
    pub(crate) file_specs: Vec<CFileSpec>,
    pub(crate) body_file_names: Vec<CStringWrapper>,
    pub(crate) certs_path: Vec<CStringWrapper>,
}
Unixcoder Score: 0.029471375048160553
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct CTaskInfo {
    pub(crate) bundle: CStringWrapper,
    pub(crate) url: CStringWrapper,
    pub(crate) data: CStringWrapper,
    pub(crate) token: CStringWrapper,
    pub(crate) form_items_ptr: *const CFormItem,
    pub(crate) form_items_len: u32,
    pub(crate) file_specs_ptr: *const CFileSpec,
    pub(crate) file_specs_len: u32,
    pub(crate) title: CStringWrapper,
    pub(crate) description: CStringWrapper,
    pub(crate) mime_type: CStringWrapper,
    pub(crate) progress: CProgress,
    pub(crate) common_data: CommonTaskInfo,
    pub(crate) max_speed: i64,
    pub(crate) task_time: u64,
}
Unixcoder Score: 0.02513555809855461
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub struct ConfigBuilder {
    inner: TaskConfig,
}
Unixcoder Score: 0.020069854333996773
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct CTaskConfig {
    pub(crate) bundle: CStringWrapper,
    pub(crate) bundle_type: u8,
    pub(crate) atomic_account: CStringWrapper,
    pub(crate) url: CStringWrapper,
    pub(crate) title: CStringWrapper,
    pub(crate) description: CStringWrapper,
    pub(crate) method: CStringWrapper,
    pub(crate) headers: CStringWrapper,
    pub(crate) data: CStringWrapper,
    pub(crate) token: CStringWrapper,
    pub(crate) proxy: CStringWrapper,
    pub(crate) certificate_pins: CStringWrapper,
    pub(crate) extras: CStringWrapper,
    pub(crate) version: u8,
    pub(crate) form_items_ptr: *const CFormItem,
    pub(crate) form_items_len: u32,
    pub(crate) file_specs_ptr: *const CFileSpec,
    pub(crate) file_specs_len: u32,
    pub(crate) body_file_names_ptr: *const CStringWrapper,
    pub(crate) body_file_names_len: u32,
    pub(crate) certs_path_ptr: *const CStringWrapper,
    pub(crate) certs_path_len: u32,
    pub(crate) common_data: CommonCTaskConfig,
}
Unixcoder Score: 0.013989453203976154
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct ConfigSet {
    pub(crate) headers: String,
    pub(crate) extras: String,
    pub(crate) form_items: Vec<CFormItem>,
    pub(crate) file_specs: Vec<CFileSpec>,
    pub(crate) body_file_names: Vec<CStringWrapper>,
    pub(crate) certs_path: Vec<CStringWrapper>,
}
Unixcoder Score: 0.009740665555000305
--------------------------------------------------
C_Code: 
void DownloadServiceTask::PublishNotification(bool background, uint32_t percent)
{
    if (!background) {
        return;
    }
    pid_t pid = static_cast<pid_t>(config_.GetApplicationInfoUid());
    std::string filePath = config_.GetFilePath();
    DownloadBackgroundNotification::PublishDownloadNotification(taskId_, pid, filePath, percent);
}
Function: 
fn background_notify(&self) {
        log_info!("background notify");
        if self.conf.version == Version::API9 && !self.conf.common_data.background {
            return;
        }
        if self.conf.version == Version::API10 && self.conf.common_data.mode == Mode::FRONTEND {
            return;
        }
        if self.file_total_size.load(Ordering::SeqCst) == -1 {
            return;
        }
        self.background_notify_time
            .store(get_current_timestamp(), Ordering::SeqCst);
        let index = self.progress.lock().unwrap().common_data.index;
        if index >= self.conf.file_specs.len() {
            return;
        }
        let file_path = self.conf.file_specs[index].path.as_ptr() as *const c_char;
        let file_path_len = self.conf.file_specs[index].path.as_bytes().len() as i32;
        let percent = self.calculate_progress();
        unsafe {
            BackgroundNotify(
                self.task_id,
                self.uid as i32,
                file_path,
                file_path_len,
                percent as u32,
            );
        };
    }
Extracted_Knowledge: 
[{"knowledge_type": "API_Mapping", "source_c_file": "Partial__NewConfig__idx1411_rank1.h", "source_rust_file": "Partial__NewConfig__idx1411_rank1.rs", "c_api": "std::make_unique<T>()", "rust_api": "Box::new(T)", "mapping_type": "pattern", "description": "Heap allocation and object construction pattern", "reasoning": "[Task Analysis] C function creates a unique_ptr to RdbStoreConfig using make_unique, Rust function creates a new struct with inner field set to result of NewConfig call. [Similarity] Names don't match exactly but both represent creation of a config object. [Knowledge Extraction] Found partial structural match in object construction logic and API mapping for heap allocation pattern."}, {"knowledge_type": "Partial", "source_c_file": "Partial__NewConfig__idx1411_rank1.h", "source_rust_file": "Partial__NewConfig__idx1411_rank1.rs", "c_fragment": "return std::make_unique<RdbStoreConfig>(std::string(path));", "rust_fragment": "Self { inner: NewConfig(path), version: 1, callback: Box::new(DefaultCallback), }", "description": "Both create and initialize a configuration object with a path parameter", "reasoning": "[Task Analysis] C function creates a unique_ptr to RdbStoreConfig using make_unique, Rust function creates a new struct with inner field set to result of NewConfig call. [Similarity] Names don't match exactly but both represent creation of a config object. [Knowledge Extraction] Found partial structural match in object construction logic and API mapping for heap allocation pattern."}]
Unixcoder Score: 0.008192033506929874
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct RequestTask {
    pub(crate) conf: TaskConfig,
    pub(crate) client: ylong_runtime::sync::Mutex<Client>,
    pub(crate) files: Files,
    pub(crate) body_files: Files,
    pub(crate) ctime: u64,
    pub(crate) mime_type: Mutex<String>,
    pub(crate) progress: Mutex<Progress>,
    pub(crate) status: Mutex<TaskStatus>,
    pub(crate) code: Mutex<Vec<Reason>>,
    pub(crate) tries: AtomicU32,
    pub(crate) background_notify_time: AtomicU64,
    pub(crate) background_notify: Arc<AtomicBool>,
    pub(crate) file_total_size: AtomicI64,
    pub(crate) rate_limiting: AtomicU64,
    pub(crate) max_speed: AtomicI64,
    pub(crate) last_notify: AtomicU64,
    pub(crate) client_manager: ClientManagerEntry,
    pub(crate) running_result: Mutex<Option<Result<(), Reason>>>,
    pub(crate) timeout_tries: AtomicU32,
    pub(crate) upload_resume: AtomicBool,
    pub(crate) mode: AtomicU8,
    pub(crate) start_time: AtomicU64,
    pub(crate) task_time: AtomicU64,
    pub(crate) rest_time: AtomicU64,
}
Unixcoder Score: 0.002668592147529125
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub struct ConfigBuilder {
    inner: TaskConfig,
}
Unixcoder Score: 0.001033141161315143
--------------------------------------------------
C_Code: 
struct CTaskConfig {
    CStringWrapper bundle;
    uint8_t bundleType;
    CStringWrapper atomicAccount;
    CStringWrapper url;
    CStringWrapper title;
    CStringWrapper description;
    CStringWrapper method;
    CStringWrapper headers;
    CStringWrapper data;
    CStringWrapper token;
    CStringWrapper proxy;
    CStringWrapper certificatePins;
    CStringWrapper extras;
    uint8_t version;
    CFormItem *formItemsPtr;
    uint32_t formItemsLen;
    CFileSpec *fileSpecsPtr;
    uint32_t fileSpecsLen;
    CStringWrapper *bodyFileNamesPtr;
    uint32_t bodyFileNamesLen;
    CStringWrapper *certsPathPtr;
    uint32_t certsPathLen;
    CommonTaskConfig commonData;
}
Function: 
pub(crate) struct CTaskConfig {
    pub(crate) bundle: CStringWrapper,
    pub(crate) bundle_type: u8,
    pub(crate) atomic_account: CStringWrapper,
    pub(crate) url: CStringWrapper,
    pub(crate) title: CStringWrapper,
    pub(crate) description: CStringWrapper,
    pub(crate) method: CStringWrapper,
    pub(crate) headers: CStringWrapper,
    pub(crate) data: CStringWrapper,
    pub(crate) token: CStringWrapper,
    pub(crate) proxy: CStringWrapper,
    pub(crate) certificate_pins: CStringWrapper,
    pub(crate) extras: CStringWrapper,
    pub(crate) version: u8,
    pub(crate) form_items_ptr: *const CFormItem,
    pub(crate) form_items_len: u32,
    pub(crate) file_specs_ptr: *const CFileSpec,
    pub(crate) file_specs_len: u32,
    pub(crate) body_file_names_ptr: *const CStringWrapper,
    pub(crate) body_file_names_len: u32,
    pub(crate) certs_path_ptr: *const CStringWrapper,
    pub(crate) certs_path_len: u32,
    pub(crate) common_data: CommonCTaskConfig,
}
Unixcoder Score: -0.007188471965491772
--------------------------------------------------
C_Code: 
int rust_get_path_array(void * p, size_t * sz)
{
  char *path, *str;
  char **buf;
  int i, num;
  size_t len;

  if ((p == NULL) && (sz == NULL))
    return -1;

  /* get the length of the PATH value */
  if (rust_get_path(NULL, &len) == -1)
    return -1;

  if (len == 0)
    return -1;

  /* allocate the buffer */
  if ((path = calloc(len, sizeof(char))) == NULL)
    return -1;

  /* get the PATH value */
  if (rust_get_path(path, &len) == -1)
  {
    free(path);
    return -1;
  }

  /* count the number of parts in the PATH */
  num = 1;
  for(str = path; *str != '\0'; str++)
  {
    if (*str == ':')
      num++;
  }

  /* calculate the size of the buffer for the 2D array */
  len = (num * sizeof(char*) + 1) + strlen(path) + 1;

  if (p == NULL)
  {
    free(path);
    *sz = len;
    return 0;
  }

  /* make sure we have enough buffer space */
  if (*sz < len)
  {
    free(path);
    return -1;
  }

  /* zero out the buffer */
  buf = (char**)p;
  memset(buf, 0, *sz);

  /* copy the data into the right place */
  str = p + ((num+1) * sizeof(char*));
  memcpy(str, path, strlen(path));

  /* parse the path into it's parts */
  for (i = 0; i < num && (buf[i] = strsep(&str, ":")) != NULL; i++) {;}
  buf[num] = NULL;

  free(path);
  return 0;
}
Function: 
pub fn with_ref<T>(&self, f: &fn(*libc::c_char) -> T) -> T {
        if self.buf.is_null() {
            fail!("CString already wraps a `*libc::c_char`");
        }
        f(self.buf)
    }
Unixcoder Score: -0.00790906511247158
--------------------------------------------------
